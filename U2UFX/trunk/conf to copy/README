This package contains only hidden files


//Tables

CREATE TABLE SHAREDFILES
(
    SHA1_SF VARCHAR(40) NOT NULL PRIMARY KEY,
    NAME_SF VARCHAR(255) NOT NULL,
    PATH_SF VARCHAR(255) NOT NULL,
    ADV_SF BLOB NOT NULL,
    CHUNK_SIZE_SF SMALLINT NOT NULL,
    COMPLETE VARCHAR(1) NOT NULL,
    CHECK(COMPLETE IN('T','F'))
)

CREATE TABLE CHUNKS
(
    SHA1_CHUNK VARCHAR(40) NOT NULL PRIMARY KEY,
    SHA1_SF VARCHAR(40) NOT NULL,
    POS_CHUNK SMALLINT NOT NULL CHECK(POS_CHUNK BETWEEN 0 AND 32767),
    STATUS VARCHAR(1) NOT NULL CHECK(STATUS IN('T','F')),

    FOREIGN KEY(SHA1_SF) REFERENCES SHAREDFILES(SHA1_SF) ON DELETE CASCADE
)

CREATE TABLE ADDRESS 
(
	ID_ADD INT NOT NULL PRIMARY KEY GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
	PIPEID_ADD VARCHAR(66) NOT NULL UNIQUE
)

CREATE TABLE CHUNKS_ADD
(
    ID_ADD INT NOT NULL,
    SHA1_CHUNK VARCHAR(40) NOT NULL,

    PRIMARY KEY (ID_ADD, SHA1_CHUNK),
    FOREIGN KEY(ID_ADD) REFERENCES ADDRESS(ID_ADD) ON DELETE CASCADE,
    FOREIGN KEY(SHA1_CHUNK) REFERENCES CHUNKS(SHA1_CHUNK) ON DELETE CASCADE
)

//Index

CREATE INDEX SF_CHUNK_ST_INDEX ON U2U.CHUNKS(SHA1_SF, POS_CHUNK, STATUS)

